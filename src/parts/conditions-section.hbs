<section class="conditions-section">
	<h2> Conditions
		<a class="addCondition">
			<i class="fa-solid fa-plus"> </i>
		</a>
	</h2>
	{{#each effect.conditions as |cond j|}}
	<div class="condition-block" data-precondition-index="{{j}}">
		<div class="type-selector">
			<label>
				type:
			</label>
			<select name="system.effects.{{../i}}.conditions.{{j}}.type">
				{{selectOptions ../POWERSTUFF.PRECONDITIONTYPES localize=true selected=cond.type}}
			</select>
			{{#if (eq cond.type	"power-damage-type-is")}}
			<select name="system.effects.{{../i}}.conditions.{{j}}.powerDamageType">
				{{selectOptions ../POWERSTUFF.DAMAGETYPES localize=true selected=cond.powerDamageType}}
			</select>
			{{/if}}
			{{#if (strIncludes cond.type "has-tag")}}
			<select name="system.effects.{{../i}}.conditions.{{j}}.powerTag">
				{{selectOptions ../POWERSTUFF.TAGS localize=true selected=cond.powerTag}}
			</select>
			{{/if}}
			{{#if (strIncludes cond.type "not-tag")}}
			<select name="system.effects.{{../i}}.conditions.{{j}}.powerTag">
				{{selectOptions ../POWERSTUFF.TAGS localize=true selected=cond.powerTag}}
			</select>
			{{/if}}

			{{#if (strIncludes cond.type "numeric")}}
			<div>
				<label for="comparison-target">
					Target
				</label>
				<select id="comparison-target" name="system.effects.{{../i}}.conditions.{{j}}.comparisonTarget">
					{{selectOptions ../POWERSTUFF.NUMERIC_COMPARISON_TARGET localize=true selected=cond.comparisonTarget}}
				</select>
			</div>
			<div>
				<select id="comparator" name="system.effects.{{../i}}.conditions.{{j}}.comparator">
					{{selectOptions ../POWERSTUFF.COMPARATORS localize=false selected=cond.comparator}}
				</select>
				<input class="short" type=number name="system.effects.{{../i}}.conditions.{{j}}.num" value="{{cond.num}}">
			</div>
			{{/if}}

			{{#if (eq cond.type "boolean")}}

			{{#if (eqAny cond.boolComparisonTarget "engaged" "engaged-with" "is-pc" "is-shadow" "is-dead" "is-same-arcana" "struck-weakness" "has-status" "flag-state")}}
			<div>
				<select name="system.effects.{{../i}}.conditions.{{j}}.conditionTarget">
					{{selectOptions ../POWERSTUFF.CONDITION_TARGETS localize=true selected=cond.conditionTarget}}
				</select>
			</div>
			{{/if}}

			<div>
				<select id="comparison-target" name="system.effects.{{../i}}.conditions.{{j}}.boolComparisonTarget">
					{{selectOptions ../POWERSTUFF.BOOLEAN_COMPARISON_TARGET localize=true selected=cond.boolComparisonTarget}}
				</select>
			</div>
			<div>
				<label>
					Is True</label>
				<input type="checkbox" id="flagState" name="system.effects.{{../i}}.conditions.{{j}}.booleanState" {{checked cond.booleanState}}>
			</div>
			{{#if (strIncludes cond.boolComparisonTarget "status")}}
			<select name="system.effects.{{../i}}.conditions.{{j}}.status">
				{{selectOptions ../POWERSTUFF.STATUSEFFECTS localize=true selected=cond.status}}
			</select>
			{{/if}}
			{{#if (strIncludes cond.boolComparisonTarget "damage")}}
			<select name="system.effects.{{../i}}.conditions.{{j}}.powerDamageType">
				{{selectOptions ../POWERSTUFF.DAMAGETYPES localize=true selected=cond.powerDamageType}}
			</select>
			{{/if}}
			{{#if (strIncludes cond.boolComparisonTarget "resistant")}}
			<select name="system.effects.{{../i}}.conditions.{{j}}.powerDamageType">
				{{selectOptions ../POWERSTUFF.DAMAGETYPES localize=true selected=cond.powerDamageType}}
			</select>
			{{/if}}
			{{#if (strIncludes cond.boolComparisonTarget "tag")}}
			<select name="system.effects.{{../i}}.conditions.{{j}}.powerTag">
				{{selectOptions ../POWERSTUFF.TAGS localize=true selected=cond.powerTag}}
			</select>
			{{/if}}
			{{#if (eq cond.boolComparisonTarget	"power-type-is")}}
			<select name="system.effects.{{../i}}.conditions.{{j}}.powerType">
				{{selectOptions ../POWERSTUFF.POWERTYPES localize=true selected=cond.powerType}}
			</select>
			{{/if}}
			{{#if (eq cond.boolComparisonTarget "flag-state")}}
			<label>Flag Id </label>
			<input class="flag-id" type="text" width=2 name="system.effects.{{../i}}.conditions.{{j}}.flagId" value="{{cond.flagId}}">
			</input>
			{{/if}}
			{{/if}}

			{{#if (strIncludes cond.type "resistant")}}
			<select name="system.effects.{{../i}}.conditions.{{j}}.powerDamageType">
				{{selectOptions ../POWERSTUFF.DAMAGETYPES localize=true selected=cond.powerDamageType}}
			</select>
			{{/if}}
			{{#if (or (strIncludes cond.type "status") (eq cond.type "save-versus"))}}
			<select name="system.effects.{{../i}}.conditions.{{j}}.status">
				{{selectOptions ../POWERSTUFF.STATUSEFFECTS localize=true selected=cond.status}}
			</select>
			{{/if}}
			{{#if (eq cond.type	"power-type-is")}}
			<select name="system.effects.{{../i}}.conditions.{{j}}.powerType">
				{{selectOptions ../POWERSTUFF.POWERTYPES localize=true selected=cond.powerType}}
			</select>
			{{/if}}

			{{#if (eq cond.type	"on-trigger")}}
			<select name="system.effects.{{../i}}.conditions.{{j}}.trigger">
				{{selectOptions ../POWERSTUFF.TRIGGERS localize=true selected=cond.trigger}}
			</select>
			{{#if (eq cond.trigger "on-attain-tarot-perk")}}
			<select name="system.effects.{{../i}}.conditions.{{j}}.tarot">
				{{selectOptions ../POWERSTUFF.TAROT_DECK localize=true selected=cond.tarot}}
			</select>

			{{/if}}

			{{/if}}

			{{#if (eq cond.type	"flag-state")}}
			<select name="system.effects.{{../i}}.conditions.{{j}}.conditionTarget">
				{{selectOptions ../POWERSTUFF.CONDITION_TARGETS localize=true selected=cond.conditionTarget}}
			</select>
			<br>
			<label>Flag Id </label>
			<input class="flag-id" type="text" width=2 name="system.effects.{{../i}}.conditions.{{j}}.flagId" value="{{cond.flagId}}">
			</input>
			<div>
				<label for="flagState">
					Flag Is Set
				</label>
				<input type="checkbox" id="flagState" name="system.effects.{{../i}}.conditions.{{j}}.booleanState" {{checked cond.booleanState}}>
			</div>


				{{/if}}
			</div>
			<a class="delCondition">
				<i class="fa-solid fa-trash-can"></i>
			</a>
		</div>
		{{/each}}
</section>
